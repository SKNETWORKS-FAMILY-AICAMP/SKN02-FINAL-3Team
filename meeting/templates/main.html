<!DOCTYPE html>
{% load static %}
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Split View Meeting List</title>
    <link href="{% static 'meeting/bootstrap/bootstrap.css' %}" rel="stylesheet" media="screen">
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="{% static 'meeting/jquery/jquery.css' %}" media="screen">
    <link rel="stylesheet" href="{% static 'meeting/css/main.css' %}" media="screen">
  </head>
  <body>
    <div class="main-container">
        <div class="header">
          <button>알림함</button>
          {% if user.is_authenticated %}
          <div>{{ user.last_name }}{{ user.first_name }}님, 안녕하세요!</div>
          {% else %}
          <a href="{% url 'login' %}">로그인</a>
          {% endif %}
        </div>
        <div class="meeting-list">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="dropdown">
              <button
                class="btn btn-light dropdown-toggle"
                type="button"
                id="dropdownMenuButton"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                제목
              </button>
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" href="#" id="search-title">제목</a>
                <a class="dropdown-item" href="#" id="search-author">작성자</a>
                <a class="dropdown-item" href="#" id="search-date">날짜</a>
                <a class="dropdown-item" href="#" id="search-summary">요약문</a>
              </div>
            </div>
          </div>
          <div class="create-meeting">
            <a class="nav-link" href="{% url 'recording' %}">+ 새 회의 만들기</a>
          </div>

        <div class="list-container" id="list-container">
            <h2>Meeting List</h2>
            <div id="list-items">
                {% for meeting in meetings %}
                    <div class="list-item" onclick="toggleDetails('{{ meeting.title|escapejs }}', '{{ meeting.started_at|date:"Y-m-d H:i"|escapejs }}', '{{ meeting.host|escapejs }}')">
                        <span class="list-item-title">{{ meeting.title }}</span>
                        <span class="list-item-info">{{ meeting.started_at|date:"Y-m-d H:i" }} {{ meeting.host }}</span>
                    </div>
                {% endfor %}
            </div>
        </div>

        <div class="details-container" id="details">
            <h2 id="details-title">요약본</h2>
            <p id="details-content">Select an item from the list to see more details here.</p>
        </div>
    </div>



    <script>
      let currentItem = null;

      function toggleDetails(title, startedAt, host) {
            const listContainer = document.getElementById('list-container');
            const detailsContainer = document.getElementById('details');
            const detailsTitle = document.getElementById('details-title');
            const detailsContent = document.getElementById('details-content');

            if (currentItem === title) {
                // Hide the details if the same item is clicked again
                detailsContainer.classList.remove('open');
                listContainer.classList.remove('split-view');
                currentItem = null;
            } else {
                // Show the details of the selected item
                detailsTitle.innerText = title;
                detailsContent.innerText = `Title: ${title}\nStarted at: ${startedAt}\nHost: ${host}`;
                detailsContainer.classList.add('open');
                listContainer.classList.add('split-view');
                currentItem = title;
            }
        }


        $("#search-title").click(function () {
          const query = prompt("검색할 제목을 입력하세요:");
          if (query) {
            console.log("제목 검색어:", query);
            $(".meeting-list")
              .empty()
              .append("<div>제목 검색 결과: " + query + "</div>");
          }
        });

        $("#search-author").click(function () {
          const query = prompt("검색할 작성자를 입력하세요:");
          if (query) {
            console.log("작성자 검색어:", query);
            $(".meeting-list")
              .empty()
              .append("<div>작성자 검색 결과: " + query + "</div>");
          }
        });

        $("#search-date").click(function () {
          const query = prompt("검색할 날짜를 입력하세요 (YYYY-MM-DD):");
          if (query) {
            console.log("날짜 검색어:", query);
            $(".meeting-list")
              .empty()
              .append("<div>날짜 검색 결과: " + query + "</div>");
          }
        });

        $("#search-summary").click(function () {
          const query = prompt("검색할 요약문을 입력하세요:");
          if (query) {
            console.log("요약문 검색어:", query);
            $(".meeting-list")
              .empty()
              .append("<div>요약문 검색 결과: " + query + "</div>");
          }
        });

    </script>
  </body>
</html>